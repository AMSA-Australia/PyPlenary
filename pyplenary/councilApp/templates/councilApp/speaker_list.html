{% extends 'councilApp/base.html' %}
{% load static %}

{% comment %}
    Copyright © 2021  Lee Yingtong Li (RunasSudo), Allen Gu

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.
{% endcomment %}

{% block title %}Speaker List{% endblock %}

{% block content %}
  <div style="max-width: 600px; margin: 0 auto;">
    <h2 class="mb-3">Speaker List</h2>

    <div id="speaker-controls" class="row mb-3">
      <div class="col-12 col-md-6 mb-2 mb-md-0">
        <button name="action" value="remove" class="btn btn-secondary w-100"{% if not on_list %} style="display:none;"{% endif %}>Remove yourself from the list</a>
        <button name="action" value="add" class="btn btn-primary w-100"{% if on_list %} style="display:none;"{% endif %}>Add yourself to the speaker list</a>
      </div>
      <div class="col-12 col-md-6">
        <button name="action" value="point_order" class="btn btn-danger w-100"><i class="bi bi-exclamation-triangle-fill"></i> Raise a point of order</a>
      </div>
    </div>

    <div id="adding-spinner" class="text-muted text-center mb-2" style="display:none;">
      <div class="spinner-border" role="status"></div>
    </div>

    <div class="list-group" id="speaker-list"></div>

    <div id="updating-spinner" class="text-muted text-end small mt-2" style="display:none;">
      <div class="spinner-border spinner-border-sm" role="status"></div> Updating…
    </div>
  </div>
{% endblock %}

{% block head %}
  {{ block.super }}
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/dragula@3.7.3/dist/dragula.min.css" integrity="sha256-kbjOP63kZCB+lxhssN+h5qDCLSLI7EhP3/r2S/jPCd4=" crossorigin="anonymous">
{% endblock %}

{% block script %}
  {{ block.super }}
  <script src="{% static 'councilApp/js/speakerList-refresh.js' %}"></script>
  {% if user.delegate.superadmin %}
  <script src="https://cdn.jsdelivr.net/npm/dragula@3.7.3/dist/dragula.min.js" integrity="sha256-egj5xxtj40Ds0GUbObVZ7m2LEOsnvu9i5Ogtmd1I+jk=" crossorigin="anonymous"></script>
  <script>
    $(function() {
      $('[data-toggle="tooltip"]').tooltip();
    });

    var dragulaSL = dragula([document.querySelector('#speaker-list')]);

    dragulaSL.on("drop", function(el, target, source, sibling) {
      alert("Dragged and dropped!");
    });
  </script>
  {% endif %}
{% endblock %}
